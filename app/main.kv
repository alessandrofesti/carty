#: import utils kivy.utils
#: import FadeTransition kivy.uix.screenmanager.FadeTransition
#: import SlideTransition kivy.uix.screenmanager.SlideTransition

<ItemDrawer>:
    theme_text_color: "Custom"
    on_release: self.parent.set_color_item(self)
    IconLeftWidget:
        id: icon
        icon: root.icon
        theme_text_color: "Custom"
        text_color: root.text_color

<ContentNavigationDrawer>:
    ScrollView:
        MDList:
            id: container
            OneLineListItem:
                text: "Profile"
                on_press:
                    root.nav_drawer.set_state("close")
                    root.screen_manager.current = "screen profile"
            OneLineListItem:
                text: "Join existing group"
                on_press:
                    root.nav_drawer.set_state("close")
                    root.screen_manager.current = "screen join group"


ScreenManager:
    HelloScreen:
    MainScreen:
    LoginScreen:
    SignupScreen:
    InputScreen:
    ForgotPasswordScreen:

<HelloScreen>:
    id: hello
    name: 'hello'
    MDLabel:
        id: carty
        text: 'CARTY'
        halign: 'center'
        theme_text_color: 'Custom'
        text_color: (153,0,153)
        font_style: 'H1'
        font_size: sp(50)
    MDSpinner:
        id: spinner
        size_hint: None, None
        size: dp(46), dp(46)
        pos_hint: {'center_x': .5, 'center_y': .3}
        active: True
    MDLabel:
        text: 'Optimize your party shifts'
        pos_hint: {'center_x':0.5,'center_y':0.44}
        theme_text_color: 'Custom'
        text_color: (153,0,153)
        halign: 'center'
        font_style: 'H1'
        font_size: sp(15)
        helper_text_mode: "on_focus"

<MainScreen>:
    id: main
    name: 'main'
    MDToolbar:
        id: toolbar
        pos_hint: {"top": 1}
        elevation: 10
        title: "Ciao Bello"
        left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
        right_action_items: [["plus-circle", lambda x: app.root.get_screen('main').change_screen('scr add group')]]
    MDNavigationLayout:
        x: toolbar.height
        size_hint_y: 1.0 - toolbar.height/root.height
        ScreenManager:
            id: screen_manager
            MDScreen:
                id: screen_add_group
                name: "scr add group"
                MDFloatLayout:
                    size: root.width, root.height
                    canvas.before:
                        Rectangle:
                            size: self.size
                            pos: self.pos
                    MDIconButton:
                        icon: 'dice-multiple'
                        user_font_size : 40
                        theme_text_color: "Custom"
                        text_color: app.theme_cls.primary_color
                        pos_hint: {'top': 0.9, 'center_x': 0.5}
                    MDTextField:
                        id: group_name
                        halign: "center"
                        size_hint_x: .6
                        size_hint_y: .1
                        pos_hint: {'top': 0.7, 'center_x': 0.5}
                        hint_text: 'Group name'
                        mode: "line"
                        color_mode: 'accent'
                        icon_right: 'account'
                    MDTextField:
                        id: group_password
                        halign: "center"
                        size_hint_x: .6
                        size_hint_y: .1
                        pos_hint: {'top': 0.6, 'center_x': 0.5}
                        hint_text: 'Group Password'
                        mode: "line"
                        color_mode: 'accent'
                        icon_right: 'onepassword'
                    MDTextField:
                        id: group_destination_address
                        halign: "center"
                        size_hint_x: .6
                        size_hint_y: .1
                        pos_hint: {'top': 0.5, 'center_x': 0.5}
                        hint_text: 'Group destination address'
                        mode: "line"
                        color_mode: 'accent'
                        icon_right: 'google-maps'
                    MDTextField:
                        id: user_departure_address
                        halign: "center"
                        size_hint_x: .6
                        size_hint_y: .1
                        pos_hint: {'top': 0.4, 'center_x': 0.5}
                        hint_text: 'Your departure address'
                        mode: "line"
                        color_mode: 'accent'
                        icon_right: 'google-maps'
                    MDTextField:
                        id: user_n_avaliable_places
                        halign: "center"
                        size_hint_x: .6
                        size_hint_y: .1
                        pos_hint: {'top': 0.3, 'center_x': 0.5}
                        hint_text: 'Number of avaliable places you have (you can change it later)'
                        mode: "line"
                        color_mode: 'accent'
                        icon_right: 'account-group'
                    MDFillRoundFlatButton:
                        pos_hint: {'top': 0.15, 'center_x': 0.5}
                        size_hint_x: .7
                        size_hint_y: .05
                        text:'Create new group'
                        on_press: root.create_new_group()
            MDScreen:
                id: screen_profile
                name: "screen profile"
                MDLabel:
                    text: "Screen profile"
                    halign: "center"
                MDLabel:
                    id: label_screen_delete
                    text: "Delete account"
                    halign: "center"
                MDRaisedButton:
                    id: button_screen_delete
                    text:'Delete account'
                    size_hint: (0.13,0.07)
                    pos_hint: {'center_x':0.5,'center_y':0.8}
                    on_press:
                        app.DeleteAccount()
                        root.manager.current = 'signup'
            MDScreen:
                id: screen_join_group
                name: "screen join group"
                MDFloatLayout:
                    size: root.width, root.height
                    canvas.before:
                        Rectangle:
                            size: self.size
                            pos: self.pos
                    MDIconButton:
                        icon: 'dice-multiple'
                        user_font_size : 40
                        theme_text_color: "Custom"
                        text_color: app.theme_cls.primary_color
                        pos_hint: {'top': 0.9, 'center_x': 0.5}
                    MDTextField:
                        id: add_group_name
                        halign: "center"
                        size_hint_x: .6
                        size_hint_y: .1
                        pos_hint: {'top': 0.7, 'center_x': 0.5}
                        hint_text: 'Group name'
                        mode: "line"
                        color_mode: 'accent'
                        icon_right: 'account'
                    MDTextField:
                        id: add_group_password
                        halign: "center"
                        size_hint_x: .6
                        size_hint_y: .1
                        pos_hint: {'top': 0.6, 'center_x': 0.5}
                        hint_text: 'Group Password'
                        mode: "line"
                        color_mode: 'accent'
                        icon_right: 'onepassword'
                    MDFillRoundFlatButton:
                        pos_hint: {'top': 0.35, 'center_x': 0.5}
                        size_hint_x: .7
                        size_hint_y: .05
                        text:'Join exixsting group'
                        on_press: root.create_new_group

        MDNavigationDrawer:
            type: "standard"
            id: nav_drawer
            ContentNavigationDrawer:
                id: contentnavigationdrawer
                screen_manager: screen_manager
                nav_drawer: nav_drawer

<LoginScreen>:
    id: login
    name:'login'
    MDFloatLayout:
        size: root.width, root.height
        canvas.before:
            Rectangle:
                size: self.size
                pos: self.pos
        MDIconButton:
            icon: 'dice-multiple'
            user_font_size : 40
            theme_text_color: "Custom"
            text_color: app.theme_cls.primary_color
            pos_hint: {'top': 0.8, 'center_x': 0.5}
        MDTextField:
            id:login_email
            halign: "center"
            size_hint_x: .6
            size_hint_y: .1
            pos_hint: {'top': 0.65, 'center_x': 0.5}
            hint_text: 'Email'
            mode: "line"
            color_mode: 'accent'
            icon_right: 'email'
        MDTextField:
            id:login_password
            halign: "center"
            size_hint_x: .6
            size_hint_y: .1
            pos_hint: {'top': 0.55, 'center_x': 0.5}
            hint_text: 'Password'
            mode: "line"
            color_mode: 'accent'
            icon_right: 'onepassword'
        MDFillRoundFlatButton:
            pos_hint: {'top': 0.4, 'center_x': 0.5}
            size_hint_x: .7
            size_hint_y: .05
            text:'Login'
            on_press:
                app.login()
        MDTextButton:
            text: 'Create an account'
            pos_hint: {'top': 0.3, 'center_x': 0.4}
            on_press:
                root.manager.current = 'signup'
                root.manager.transition.direction = 'up'
        MDTextButton:
            text: 'Forgot password'
            pos_hint: {'top': 0.3, 'center_x': 0.6}
            on_press:
                root.manager.current = 'resetpassword'


<SignupScreen>:
    id: signup
    name:'signup'
    MDFloatLayout:
        size: root.width, root.height
        canvas.before:
            Rectangle:
                size: self.size
                pos: self.pos
        MDIconButton:
            icon: 'dice-multiple'
            user_font_size : 40
            theme_text_color: "Custom"
            text_color: app.theme_cls.primary_color
            pos_hint: {'top': 0.9, 'center_x': 0.5}
        MDTextField:
            id:signup_email
            halign: "center"
            size_hint_x: .6
            size_hint_y: .1
            pos_hint: {'top': 0.75, 'center_x': 0.5}
            hint_text: 'Email'
            mode: "line"
            color_mode: 'accent'
            icon_right: 'email'
        MDTextField:
            id:signup_username
            halign: "center"
            size_hint_x: .6
            size_hint_y: .1
            pos_hint: {'top': 0.65, 'center_x': 0.5}
            hint_text: 'Username'
            mode: "line"
            color_mode: 'accent'
            icon_right: 'account'
        MDTextField:
            id:signup_password
            halign: "center"
            size_hint_x: .6
            size_hint_y: .1
            pos_hint: {'top': 0.55, 'center_x': 0.5}
            hint_text: 'Password'
            mode: "line"
            color_mode: 'accent'
            icon_right: 'onepassword'
        MDFillRoundFlatButton:
            pos_hint: {'top': 0.4, 'center_x': 0.5}
            size_hint_x: .7
            size_hint_y: .05
            text:'Signup'
            on_press:
                app.signup()
        MDTextButton:
            text: 'Login'
            pos_hint: {'top': 0.3, 'center_x': 0.5}
            on_press:
                root.manager.current = 'login'
                root.manager.transition.direction = 'up'

<InputScreen>:
    id: input
    name: 'input'
    MDToolbar:
        title: "Carty - optimize your shifts"
        left_action_items: [["menu", lambda x: app.callback(x)]]
        right_action_items: [["dots-vertical", lambda x: app.callback(x)]]
    MDTextField:
        hint_text: "Name"
        mode: "rectangle"
        pos_hint: {'center_x':0.5,'center_y':0.9}
    MDFlatButton:
        text: "Add"
        pos_hint: {'center_x':0.5,'center_y':0.1}
        font_size: sp(15)
        theme_text_color: "Custom"
        text_color: 0, 0, 1, 1
    MDFloatingActionButtonSpeedDial:
        root_button_anim: True

<ForgotPasswordScreen>:
    id: resetpassword
    name: 'resetpassword'
    MDFloatLayout:
        size: root.width, root.height
        canvas.before:
            Rectangle:
                size: self.size
                pos: self.pos
        MDIconButton:
            icon: 'dice-multiple'
            user_font_size : 40
            theme_text_color: "Custom"
            text_color: app.theme_cls.primary_color
            pos_hint: {'top': 0.8, 'center_x': 0.5}
        MDTextField:
            id:reset_email
            halign: "center"
            size_hint_x: .6
            size_hint_y: .1
            pos_hint: {'top': 0.6, 'center_x': 0.5}
            hint_text: 'Insert your email address'
            mode: "line"
            color_mode: 'accent'
            icon_right: 'email'
        MDFillRoundFlatButton:
            pos_hint: {'top': 0.45, 'center_x': 0.5}
            size_hint_x: .7
            size_hint_y: .05
            text:'Send reset email'
            on_press:
                app.SendResetEmail()
                root.manager.current = 'login'
        MDTextButton:
            text: 'Login'
            pos_hint: {'top': 0.35, 'center_x': 0.5}
            on_press:
                root.manager.current = 'login'
                root.manager.transition.direction = 'up'













